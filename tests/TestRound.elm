module TestRound exposing (roundTest)

import Test exposing (..)
import Expect exposing (equal)

import TestData exposing (dataFloat)
import Round

dataRound0 =
  [ "0"
  , "0"
  , "0"
  , "0"
  , "0"
  , "99"
  , "10"
  , "1"
  , "0"
  , "0"
  , "-99"
  , "-10"
  , "-1"
  , "0"
  , "0"
  , "1"
  , "1"
  , "1"
  , "1"
  , "-1"
  , "-1"
  , "-1"
  , "-1"
  , "213"
  , "213"
  , "213"
  , "213"
  , "-213"
  , "-213"
  , "-213"
  , "-213"
  , "6"
  , "6"
  , "6"
  , "6"
  , "-5" -- that's a feature, see https://msdn.microsoft.com/en-us/library/5cza0web(v=vs.94).aspx
  , "-6"
  , "-6"
  , "-6"
  , "6"
  , "6"
  , "6"
  , "6"
  , "-5" -- that's a feature, see https://msdn.microsoft.com/en-us/library/5cza0web(v=vs.94).aspx
  , "-6"
  , "-6"
  , "-6"
  , "5"
  , "5"
  , "5"
  , "5"
  , "-5"
  , "-5"
  , "-5"
  , "-5"
  ]

dataRound1 =
  [ "0.0"
  , "0.0"
  , "0.0"
  , "0.0"
  , "0.0"
  , "99.0"
  , "9.9"
  , "1.0"
  , "0.1"
  , "0.0"
  , "-99.0"
  , "-9.9"
  , "-1.0"
  , "-0.1"
  , "0.0"
  , "1.0"
  , "1.1"
  , "1.0"
  , "1.0"
  , "-1.0"
  , "-1.1"
  , "-1.0"
  , "-1.0"
  , "213.0"
  , "213.1"
  , "213.0"
  , "213.0"
  , "-213.0"
  , "-213.1"
  , "-213.0"
  , "-213.0"
  , "5.5"
  , "5.6"
  , "5.6"
  , "5.6"
  , "-5.5"
  , "-5.5"
  , "-5.6"
  , "-5.6"
  , "5.5"
  , "5.5"
  , "5.5"
  , "5.5"
  , "-5.5"
  , "-5.5"
  , "-5.5"
  , "-5.5"
  , "4.9"
  , "5.0"
  , "5.0"
  , "5.0"
  , "-4.9"
  , "-5.0"
  , "-5.0"
  , "-5.0"
  ]

dataRound2 =
  [ "0.00"
  , "0.00"
  , "0.00"
  , "0.00"
  , "0.00"
  , "99.00"
  , "9.90"
  , "0.99"
  , "0.10"
  , "0.01"
  , "-99.00"
  , "-9.90"
  , "-0.99"
  , "-0.10"
  , "-0.01"
  , "1.00"
  , "1.10"
  , "1.01"
  , "1.00"
  , "-1.00"
  , "-1.10"
  , "-1.01"
  , "-1.00"
  , "213.00"
  , "213.10"
  , "213.01"
  , "213.00"
  , "-213.00"
  , "-213.10"
  , "-213.01"
  , "-213.00"
  , "5.50"
  , "5.55"
  , "5.56"
  , "5.56"
  , "-5.50"
  , "-5.55"
  , "-5.55"
  , "-5.56"
  , "5.50"
  , "5.51"
  , "5.50"
  , "5.50"
  , "-5.50"
  , "-5.51"
  , "-5.50"
  , "-5.50"
  , "4.90"
  , "4.99"
  , "5.00"
  , "5.00"
  , "-4.90"
  , "-4.99"
  , "-5.00"
  , "-5.00"
  ]

roundTest : Test
roundTest =
    describe "round"
      <| ( List.map2
            (\a b -> 
              test ("round 0 "++(toString b)++" to "++a) 
              <| \() -> equal a (Round.round 0 b))
            dataRound0
            dataFloat
         )
         ++ 
         ( List.map2
            (\a b -> 
              test ("round 1 "++(toString b)++" to "++a) 
              <| \() -> equal a (Round.round 1 b))
            dataRound1
            dataFloat
         )
         ++ 
         ( List.map2
            (\a b -> 
              test ("round 2 "++(toString b)++" to "++a) 
              <| \() -> equal a (Round.round 2 b))
            dataRound2
            dataFloat
         )

